# 관측 가능성의 표준, 오픈텔레메트리
## 오픈텔레메트리 소개 및 컴포넌트
- 오픈텔레메트리 = 오픈트레이싱 + 오픈센서스 

- 오픈텔레메트리 구성 요소
    - 신호(Metric, Log, Trace)
    - 콘텍스트 전파
        - 다양한 스트림(업, 다운 스트림)간에 문맥을 전달하는 과정 
    - 파이프라인
### 신호의 구성 요소
1. **데이터 모델**: Metric, Log, Trace에 대한 상세한 레이아웃과 데이터 구조 기술
    - 특징
        - Telemetry가 지원할 수 있는 OTLP(OpenTelemetryProtocol)와 공급업체에 구애받지 않는 의미 체계 규칙 정의 
2. **API**: 사용자 어플리케이션 또는 타사 라이브러리가 이에 의존하고 전체 SDK 구현을 연결하지 않는 경우에도 어플리케이션이 빌드되고 실행이 이루어짐
    - 특징 
        - 오픈텔레메트리의 API는 다양한 개발 언어, 벤더 솔루션에 종속되지 않게 개발되었음 
        - 공급업체에 의존성 없이 코드를 개발할 수 있음
        - Trace, Metric, Log 데이터를 생성하고 상호 연관시키기 위한 데이터 유형과 작업을 정의함 
3. **SDK**: 로직 외적인 벤더와 기술 종속적인 문제를 해결 
    - 특징
        - 내보내기 인터페이스 정의(데이터를 백엔드로 보내는 역할) 
        - 텔레메트리를 생성,집계,전송하는 기본 시스템 구현
4. **계측 라이브러리**: 어플리케이션의 자동 계측을 위한 것
    - 예시
        - 파이썬의 플라스크, 장고와 같은 라이브러리를 otel의 계측 라이브러리를 통해 제공받을 수 있음
5. **리소스**: 텔레메트리를 생성하는 엔티티
6. **배기지**: 사용자가 정의 가능한 키-값 쌍 형식의 메타데이터
    - 스팬 사이에 전달되는 콘텍스트 정보를 나타냄 
7. **이벤트**: 스팬에서 사람이 읽을 수 있는 메시지 
8. **링크**: 스팬 간 관계를 표현하는 것 

### 파이프라인
- 각 신호에 의해 캡쳐된 텔레메트리는 저장과 분석을 수행할 수 있는 데이터 저장소로 내보내져야 함 
- 오픈텔레메트리 파이프라인 아키텍쳐 
![alt text](image.png)
- 프로바이더
    - 텔레메트리 데이터를 생성하는데 사용되는 엔티티 
    - 데이터를 생성하기 전 어플리케이션 코드 초기에 구성해야 함
- 텔레메트리 생성기
    - 텔레미트리를 생성하기 위해 프로바이더가 인스턴스화한 텔레메트리 생성기를 SDK에서 사용할 수 있음
- 프로세서
    - 데이터 내용을 추가로 수정할 수 있는 기능 제공 
- 익스포터
    - Otel 내부의 데이터 모델을 구성된 익스포터와 가장 일치하는 형식으로 변환

## Trace: Otel의 Trace
- Span: Trace 구성 요소
    - Parent span ID, Timestamps, Context, Attributes, Events, Links, Status
### Trace Pipeline 구성
- 구성 요소
    - 스팬을 생성해야 하는 방법을 결정하는 **프로바이더**
    - 스팬의 소스를 식별하는 **리소스**
    - 스팬을 내보내는 방법을 설명하는 **프로세서**
    - 스팬을 내보낼 위치를 설명하는 **익스포터**
- 과정
    - 트레이서 획득
    - 추적 데이터 생성
    - 콘텍스트 API: 스팬 연결 및 활성화 후 설정
    - 스팬 프로세서
    - 데이터 보강
    - ResourceDetector
## Metric: Otel의 Metric
- Metric: 카운터, 게이지, 히스토그램 등 다양한 메트릭 타입 지원

### Metric Pipeline 구성
- MetricProvider 초기화
- 미터 획득
- Otel 계측기 선택
